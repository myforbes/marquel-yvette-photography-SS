!function(){"use strict";function t(t,e){window.dataLayer.push({event:t,...e})}function e(){const t=window.location.pathname;return"/"===t||"/index.html"===t?"homepage":t.replace(/^\/|\.html$/g,"").replace(/-/g,"_")}function n(t){const e=document.querySelector("header"),n=document.querySelector("footer");if(e&&e.contains(t))return"header";if(n&&n.contains(t))return"footer";const o=t.closest("section");if(o){const t=o.className;if(t.includes("hero"))return"hero";if(t.includes("services"))return"services";if(t.includes("team")||t.includes("workplace"))return"workplace";if(t.includes("gift"))return"gift_card";if(t.includes("cta-section"))return"cta_section"}return"body"}function o(){const n=[25,50,75,100],o=new Set;function c(){const c=function(){const t=document.documentElement.scrollHeight-window.innerHeight;return t<=0?100:Math.round(window.scrollY/t*100)}();n.forEach(n=>{c>=n&&!o.has(n)&&(o.add(n),t("scroll_depth",{scroll_threshold:n,page_location:e()}))})}let i;window.addEventListener("scroll",function(){i||(i=setTimeout(function(){i=null,c()},100))},{passive:!0})}function c(){t("page_view_enhanced",{page_name:e(),page_title:document.title,page_path:window.location.pathname,referrer:document.referrer,screen_width:window.innerWidth,device_type:window.innerWidth<768?"mobile":window.innerWidth<1024?"tablet":"desktop"}),document.addEventListener("click",function(o){const c=o.target.closest("a.cta-button, .cta-button");if(!c)return;const i=c.textContent.trim().toUpperCase(),a=c.getAttribute("href");let r="other";i.includes("RATE")||i.includes("AVAILABILITY")||i.includes("BOOK")?r="book_session":i.includes("PROPOSAL")?r="request_proposal":i.includes("GIFT")?r="purchase_gift_card":i.includes("LEARN MORE")&&(r="learn_more"),t("cta_click",{cta_type:r,cta_text:i,cta_destination:a,page_location:e(),click_position:n(c)})}),document.addEventListener("click",function(n){const o=n.target.closest("a");if(!o)return;const c=o.getAttribute("href")||"";c.startsWith("tel:")&&t("phone_click",{phone_number:c.replace("tel:","").replace(/\D/g,""),formatted_number:o.textContent.trim(),page_location:e(),click_location:o.closest("footer")?"footer":"body"}),c.startsWith("mailto:")&&t("email_click",{email_address:c.replace("mailto:","").split("?")[0],page_location:e(),click_location:o.closest("footer")?"footer":"body"})}),o(),function(){const n=new Set;document.addEventListener("focusin",function(o){const c=o.target;if(!c.matches("input, textarea, select"))return;const i=c.closest("form");if(!i)return;const a=i.id||i.getAttribute("name")||"unknown_form";if(!n.has(a)){n.add(a);let o="unknown";a.includes("checklist")||a.includes("popup")?o="checklist_popup":(a.includes("proposal")||a.includes("contact"))&&(o="proposal_request"),t("form_start",{form_id:a,form_type:o,first_field:c.name||c.id||"unknown",page_location:e()})}}),document.addEventListener("submit",function(n){const o=n.target;if(!o.matches("form"))return;const c=o.id||o.getAttribute("name")||"unknown_form";let i="unknown";c.includes("checklist")||c.includes("popup")?i="checklist_popup":(c.includes("proposal")||c.includes("contact"))&&(i="proposal_request"),t("form_submit",{form_id:c,form_type:i,page_location:e()})})}(),document.addEventListener("change",function(n){if(!n.target.matches(".faq-toggle"))return;const o=n.target.closest(".faq-item");if(!o)return;const c=o.querySelector(".faq-question span:first-child");t("faq_interaction",{faq_question:c?c.textContent.trim():"Unknown question",faq_action:n.target.checked?"expand":"collapse",page_location:e()})}),function(){const n=document.querySelector(".header-burger-btn");n&&n.addEventListener("click",function(){t("menu_toggle",{menu_action:document.querySelector(".header-menu")?.classList.contains("menu-open")?"close":"open",page_location:e()})})}(),document.addEventListener("click",function(n){const o=n.target.closest("a");if(!o)return;const c=o.getAttribute("href")||"";let i=null;c.includes("instagram.com")?i="instagram":c.includes("facebook.com")?i="facebook":c.includes("linkedin.com")?i="linkedin":c.includes("twitter.com")||c.includes("x.com")?i="twitter":c.includes("youtube.com")&&(i="youtube"),i&&t("social_click",{social_platform:i,social_url:c,page_location:e(),click_location:o.closest("footer")?"footer":"body"})}),document.addEventListener("click",function(n){const o=n.target.closest("a");if(!o)return;const c=o.getAttribute("href")||"";if(!(!c.startsWith("http")||c.includes("marquelyvette.com")||c.includes("instagram.com")||c.includes("facebook.com")||c.includes("linkedin.com")))try{t("outbound_click",{outbound_url:c,outbound_domain:new URL(c).hostname,link_text:o.textContent.trim().substring(0,100),page_location:e()})}catch(n){}}),function(){const n=new MutationObserver(function(n){n.forEach(function(n){if("attributes"===n.type&&"class"===n.attributeName){const o=n.target;"checklist-popup-overlay"===o.id&&t("popup_interaction",{popup_name:"checklist_popup",popup_action:o.classList.contains("active")?"view":"close",page_location:e()})}})}),o=setInterval(function(){const t=document.getElementById("checklist-popup-overlay");t&&(n.observe(t,{attributes:!0}),clearInterval(o))},500);setTimeout(function(){clearInterval(o)},3e4),document.addEventListener("click",function(n){n.target.matches(".checklist-popup-dismiss")&&t("popup_interaction",{popup_name:"checklist_popup",popup_action:"dismiss",page_location:e()}),n.target.matches(".checklist-popup-close")&&t("popup_interaction",{popup_name:"checklist_popup",popup_action:"close_button",page_location:e()})})}(),document.addEventListener("click",function(n){const o=n.target.closest("a");if(!o)return;const c=o.getAttribute("href")||"";if(!c.endsWith(".html")&&"/"!==c)return;if(c.startsWith("http")&&!c.includes("marquelyvette.com"))return;if(o.classList.contains("cta-button"))return;let i=c.replace(/^\/|\.html$/g,"").replace(/-/g,"_");"/"!==c&&"/index.html"!==c||(i="homepage");let a="content_link";o.closest("nav, .header-menu")?a="header_nav":o.closest("footer")?a="footer_nav":o.closest(".footer-service-areas")&&(a="service_area_link"),t("internal_navigation",{destination_page:i,navigation_type:a,link_text:o.textContent.trim().substring(0,50),page_location:e()})}),function(){const n=[30,60,120,300],o=new Set;let c=Date.now();setInterval(function(){const i=Math.floor((Date.now()-c)/1e3);n.forEach(function(n){i>=n&&!o.has(n)&&(o.add(n),t("time_on_page",{time_threshold:n,page_location:e()}))})},5e3)}(),document.addEventListener("click",function(n){const o=n.target.closest(".gallery-grid-item img, .gallery-grid-item");if(o){const n="IMG"===o.tagName?o:o.querySelector("img");n&&t("gallery_click",{image_alt:n.alt||"unknown",gallery_type:"hero_gallery",page_location:e()})}const c=n.target.closest(".testimonial-card img, .service-card img, .about-image img");c&&t("image_click",{image_section:c.closest("section")?.className.split(" ")[0]||"unknown",image_alt:c.alt||"unknown",page_location:e()})}),console.log("GTM tracking initialized")}window.dataLayer=window.dataLayer||[],"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()}();