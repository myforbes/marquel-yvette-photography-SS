!function(){"use strict";let e=null,t=!1;const o=new Map;fetch("config/photos.json").then(e=>e.json()).then(a=>{console.log("Loading photo gallery from config..."),e=a;const n=document.querySelector(".photo-grid");if(!n)return void console.error("Photo grid container not found");n.innerHTML="";const s=[];a.gallery&&Object.entries(a.gallery).forEach(([e,t])=>{s.push({section:"gallery",key:e,src:t.src,alt:t.alt,location:"Homepage Gallery",priority:t.priority})}),a.testimonials&&Object.entries(a.testimonials).forEach(([e,t])=>{s.push({section:"testimonials",key:e,src:t.src,alt:t.alt,location:"Testimonials"})}),a.services&&Object.entries(a.services).forEach(([e,t])=>{s.push({section:"services",key:e,src:t.src,alt:t.alt,location:"Services Section"})}),a.teamHeadshots&&Object.entries(a.teamHeadshots).forEach(([e,t])=>{s.push({section:"teamHeadshots",key:e,src:t.src,alt:t.alt,location:"Team Headshots"})}),a.about&&Object.entries(a.about).forEach(([e,t])=>{s.push({section:"about",key:e,src:t.src,alt:t.alt,location:"About Section"})}),a.additionalServices&&Object.entries(a.additionalServices).forEach(([e,t])=>{s.push({section:"additionalServices",key:e,src:t.src,alt:t.alt,location:"Additional Services"})}),a.bannerGallery&&Object.entries(a.bannerGallery).forEach(([e,t])=>{s.push({section:"bannerGallery",key:e,src:t.src,alt:t.alt,location:"Rates Page Banner"})}),a.ratesTestimonials&&Object.entries(a.ratesTestimonials).forEach(([e,t])=>{s.push({section:"ratesTestimonials",key:e,src:t.src,alt:t.alt,location:"Rates Testimonials"})}),a.contactPortfolio&&Object.entries(a.contactPortfolio).forEach(([e,t])=>{s.push({section:"contactPortfolio",key:e,src:t.src,alt:t.alt,location:"Contact Page"})}),a.thankYouPortfolio&&Object.entries(a.thankYouPortfolio).forEach(([e,t])=>{s.push({section:"thankYouPortfolio",key:e,src:t.src,alt:t.alt,location:"Thank You Page"})}),a.workplaceHeadshotsPage&&Object.entries(a.workplaceHeadshotsPage).forEach(([e,t])=>{e.startsWith("_")||s.push({section:"workplaceHeadshotsPage",key:e,src:t.src,alt:t.alt,location:t.usedOn||"Workplace Headshots Page"})}),a.additionalPortfolio&&Object.entries(a.additionalPortfolio).forEach(([e,t])=>{e.startsWith("_")||s.push({section:"additionalPortfolio",key:e,src:t.src,alt:t.alt,location:"Additional Portfolio"})}),s.forEach((a,s)=>{const l=function(a){const n=document.createElement("div");n.className="photo-item",n.dataset.section=a.section,n.dataset.key=a.key;const s=document.createElement("div");s.className="photo-container";const l=document.createElement("img");l.src=a.src,l.alt=a.alt,l.loading="lazy";const c=document.createElement("div");c.className="photo-overlay";const i=document.createElement("p");i.className="photo-location",i.textContent=a.location;const r=document.createElement("p");r.className="photo-path",r.textContent=a.src,c.appendChild(i),c.appendChild(r),s.appendChild(l),s.appendChild(c);const d=document.createElement("button");return d.className="update-photo-btn",d.textContent="Update Photo",d.onclick=()=>function(a,n,s){const l=document.createElement("input");l.type="file",l.accept="image/*",l.className="file-input",l.onchange=async l=>{const c=l.target.files[0];if(!c)return;if(!c.type.startsWith("image/"))return void alert("Please select an image file");let i="images/portfolio/";n.src.includes("banner-gallery")?i="images/banner-gallery/":n.src.includes("testimonials")?i="images/testimonials/":n.src.includes("logos")?i="images/logos/":n.src.includes("backgrounds")&&(i="images/backgrounds/");const r=new FormData;r.append("photo",c),r.append("section",n.section),r.append("key",n.key),r.append("folder",i);try{a.style.opacity="0.6";const l=await fetch("http://localhost:3000/api/upload-photo",{method:"POST",body:r}),i=await l.json();if(i.success){const l=new FileReader;l.onload=e=>{s.src=e.target.result},l.readAsDataURL(c),e[n.section]&&e[n.section][n.key]&&(e[n.section][n.key].src=i.path,o.set(`${n.section}.${n.key}`,{oldPath:i.oldPath,newPath:i.path,file:c}),a.classList.add("updated"),a.style.opacity="1",t=!0,document.getElementById("deployBtn").classList.add("active"),document.getElementById("uploadInstructions").classList.add("active"),console.log("✓ Photo uploaded and saved!"),console.log(`  Section: ${n.section}.${n.key}`),console.log(`  Old: ${i.oldPath}`),console.log(`  New: ${i.path}`),console.log(`  Location: ${n.location}`))}else alert("Upload failed: "+i.error),a.style.opacity="1"}catch(e){console.error("Upload error:",e),alert("Upload failed. Make sure the photo gallery server is running on port 3000."),a.style.opacity="1"}},l.click()}(n,a,l),n.appendChild(s),n.appendChild(d),n}(a);n.appendChild(l)}),console.log(`✓ Photo gallery loaded with ${s.length} photos`),function(){const e=document.getElementById("deployBtn");e.onclick=async()=>{if(t){if(confirm("Deploy all changes to CloudFront? This will update your live website.")){e.disabled=!0,e.textContent="Deploying...",e.style.opacity="0.6";try{const t=Array.from(o.values()).map(e=>e.newPath),a=await fetch("http://localhost:3000/api/deploy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({updatedFiles:t})}),n=await a.json();n.success?(alert(`✅ Successfully deployed to CloudFront!\n\nInvalidation ID: ${n.invalidationId}\n\nYour live website will update in 1-2 minutes.`),e.textContent="Deployed ✓",e.style.background="#4CAF50",console.log("✓ Deployment complete!"),console.log(`  Invalidation ID: ${n.invalidationId}`),console.log("  Updated files:",t)):(alert("Deployment failed: "+n.error),e.disabled=!1,e.textContent="Deploy to CloudFront",e.style.opacity="1")}catch(t){console.error("Deploy error:",t),alert("Deployment failed. Make sure the photo gallery server is running and AWS CLI is configured."),e.disabled=!1,e.textContent="Deploy to CloudFront",e.style.opacity="1"}}}else alert("No updates to deploy")}}()}).catch(e=>{console.error("Error loading photo gallery:",e)})}();